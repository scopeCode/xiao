<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.xcrm.core.goods">		<select id="calculateGoodsRealCost" resultType="com.xcrm.mt.bis.goods.vo.CalculateGoodsStockResult">		SELECT IF(ISNULL(SUM(IF(stockType=2,-b.stockCount*b.stockCost,b.stockCount*b.stockCost))),		         0,SUM(IF(stockType=2,-b.stockCount*b.stockCost,b.stockCount*b.stockCost))) originalStockCostSum,		       IF(ISNULL(SUM(IF(stockType=2,-b.stockCount,b.stockCount))),		       0,SUM(IF(stockType=2,-b.stockCount,b.stockCount))) AS originalCountSum ,		        a.stockUpdated,a.dataStatus AS goodsDataStatus,a.goodsRealCost AS oldGoodsRealCost		FROM t_t_goods a 		LEFT JOIN t_t_goods_stock b ON a.tenantId = b.tenantId AND a.id = b.goodsId AND b.dataStatus = 1		WHERE a.tenantId = #{tenantId} AND a.id = #{goodsId}	</select>		<update id="updateGoodsRealCost">		UPDATE t_t_goods		SET stockCount = #{allStockCount},stockUpdated = #{newStockUpdated},goodsRealCost= #{goodsRealCost}		WHERE tenantId = #{tenantId} AND id = #{goodsId} AND (ISNULL(stockUpdated) OR stockUpdated = #{oldStockUpdated})	</update>		<select id="queryGoodsStockRecord" resultType="java.util.Map">		SELECT b.goodsImage,b.goodsName,a.stockType,a.stockCount,a.stockLeftCount,a.stockDate,c.realName,a.remark		FROM t_t_goods_stock a		LEFT JOIN t_t_goods b ON a.tenantId = b.tenantId AND a.goodsId = b.id 		LEFT JOIN t_b_user c ON a.operateUserId = c.id AND c.tenantId = a.tenantId		WHERE a.tenantId = #{tenantId} AND a.dataStatus = 1 AND b.dataStatus = 1 AND a.goodsId = #{goodsId}		ORDER BY a.created DESC		<if test="start != null and start >= 0 and pageSize != null and pageSize >= 0">			LIMIT #{start},#{pageSize}		</if>		<if test="start != null and start > 0 and pageSize == null">			LIMIT #{pageSize}		</if>	</select>		<select id="queryGoodsStockRecord_count" resultType="java.lang.Integer">		SELECT COUNT(1)		FROM t_t_goods_stock a		LEFT JOIN t_t_goods b ON a.tenantId = b.tenantId AND a.goodsId = b.id 		LEFT JOIN t_b_user c ON a.operateUserId = c.id AND c.tenantId = b.tenantId		WHERE b.tenantId = #{tenantId} AND a.dataStatus = 1 AND b.dataStatus = 1 AND a.goodsId = #{goodsId}	</select>							</mapper>