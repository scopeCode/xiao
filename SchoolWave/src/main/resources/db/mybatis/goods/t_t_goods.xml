<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"><mapper namespace="com.xcrm.core.goods">	    <update id="batchDeleteGoods">    	UPDATE t_t_goods    	SET dataStatus = 0    	WHERE tenantId = #{tenantId}    	      AND id IN 			     <foreach item="item" collection="goodsIds" open="(" separator=","                 close=")">                    #{item}                 </foreach>     </update>    	<select id="searchGoodsVendorList" resultType="java.util.Map">		SELECT a.id,a.vendorName,a.contactPerson,a.phone,a.address,a.qq,a.aliAccount,			   a.bankAccount,a.bankAccountName,a.remark,b.sysName as vendorStatus,b.sysCode		FROM t_t_goods_vendor a 		LEFT JOIN t_b_sys_code b on a.vendorStatus = b.sysCode AND b.dataStatus		WHERE a.dataStatus =  1 AND a.tenantId = #{tenantId} 		<if test="queryKey != null" >			<trim prefix="AND (" suffix=")">					a.contactPerson LIKE CONCAT(#{queryKey},'%') OR a.vendorName LIKE CONCAT(#{queryKey},'%')  OR a.phone = #{queryKey}			</trim>		</if>		<if test="vendorStatus != null" >			AND a.vendorStatus = #{vendorStatus}		</if>		ORDER BY a.created DESC		<if test="start != null and start >= 0 and pageSize != null and pageSize >= 0">			LIMIT #{start},#{pageSize}		</if>		<if test="start != null and start > 0 and pageSize == null">			LIMIT #{pageSize}		</if>	</select>		<select id="searchGoodsVendorList_count" resultType="java.lang.Integer">		SELECT COUNT(1)		FROM t_t_goods_vendor a 		WHERE a.dataStatus =  1 AND a.tenantId = #{tenantId} 		<if test="queryKey != null" >			<trim prefix="AND (" suffix=")">					a.contactPerson LIKE CONCAT(#{queryKey},'%') OR a.vendorName LIKE CONCAT(#{queryKey},'%')  OR a.phone = #{queryKey}			</trim>		</if>	</select>			<resultMap id="GoodsSearchListResultMap" type="com.xcrm.mt.bis.goods.vo.GoodsSearchListResultVo">		<result property="id" column="id" />		<result property="goodsNo" column="goodsNo" />		<result property="goodsName" column="goodsName" />		<result property="goodsCategoryId" column="goodsCategoryId" />		<result property="goodsCategoryName" column="goodsCategoryName" />		<result property="goodsImage" column="goodsImage" />		<result property="price" column="price" />		<result property="isCustomDiscount" column="isCustomDiscount" />		<result property="discountInfo" column="discountInfo" />		<result property="stockCount" column="stockCount" />		<result property="goodsSpec" column="goodsSpec" />		<result property="lastOrderDay" column="lastOrderDay" />		<result property="remark" column="remark" />		<result property="goodsRealCost" column="goodsRealCost" />		<result property="goodsType" column="goodsType" />	</resultMap>		<select id="searchGoodsList" resultMap="GoodsSearchListResultMap">		SELECT a.id,a.goodsNo,a.goodsName,a.goodsCategoryId,b.categoryName AS goodsCategoryName,a.goodsImage, a.price,			   a.isCustomDiscount,IF(a.isCustomDiscount = 1,a.discount,"会员折扣") AS discountInfo,			   a.stockCount, a.goodsSpec,DATEDIFF(NOW(),a.lastOrderDate) AS lastOrderDay,a.remark,a.goodsRealCost,a.goodsType		FROM t_t_goods a         LEFT JOIN t_t_goods_category b ON a.goodsCategoryId = b.id AND a.tenantId = b.tenantId AND b.dataStatus = 1		WHERE a.dataStatus =  1 AND a.tenantId = #{tenantId} 		<if test="queryKey != null" >			<trim prefix="AND (" suffix=")">					a.goodsNo = LPAD(#{queryKey}, 5, 0) OR a.goodsName like CONCAT(#{queryKey},'%')  					OR a.goodsSpec like CONCAT('%',#{queryKey},'%') OR a.remark like CONCAT('%',#{queryKey},'%')			</trim>		</if>		<if test="goodsCategoryId != null " >			AND a.goodsCategoryId = #{goodsCategoryId}		</if>		<if test="isCustomDiscount != null and isCustomDiscount == 1" >			AND a.discount = #{discount}		</if>		<if test="isCustomDiscount != null and isCustomDiscount == 0" >			AND a.isCustomDiscount = 0		</if>		<if test="lastOrderDay != null and lastOrderDay > 0" >			AND DATEDIFF(NOW(),a.lastOrderDate) &lt;= #{lastOrderDay}		</if>		<if test="goodsType != null" >			AND goodsType = #{goodsType}		</if>				<choose>			<when test="dataOrderId != null and dataOrderId == 1 ">				<choose>				   <when test="dataOrderType != null and dataOrderType == 1">				   	  ORDER BY a.goodsCategoryId DESC,a.id ASC				   </when>				   <otherwise>				      ORDER BY a.goodsCategoryId ASC,a.id ASC				   </otherwise>				</choose>			</when>						<when test="dataOrderId != null and dataOrderId == 2 ">				<choose>				   <when test="dataOrderType != null and dataOrderType == 1">				   	  ORDER BY a.price DESC,a.id ASC				   </when>				   <otherwise>				      ORDER BY a.price ASC,a.id ASC				   </otherwise>				</choose>			</when>						<when test="dataOrderId != null and dataOrderId == 3 ">				<choose>				   <when test="dataOrderType != null and dataOrderType == 1">				   	  ORDER BY a.discount DESC,a.id ASC				   </when>				   <otherwise>				      ORDER BY a.discount ASC,a.id ASC				   </otherwise>				</choose>			</when>						<when test="dataOrderId != null and dataOrderId == 4 ">				<choose>				   <when test="dataOrderType != null and dataOrderType == 1">				   	  ORDER BY a.stockCount DESC,a.id ASC				   </when>				   <otherwise>				      ORDER BY a.stockCount ASC,a.id ASC				   </otherwise>				</choose>			</when>						<when test="dataOrderId != null and dataOrderId == 5 ">				<choose>				   <when test="dataOrderType != null and dataOrderType == 1">				   	  ORDER BY DATEDIFF(NOW(),lastOrderDate) DESC,a.id ASC				   </when>				   <otherwise>				      ORDER BY DATEDIFF(NOW(),lastOrderDate) ASC,a.id ASC				   </otherwise>				</choose>			</when>			<otherwise>ORDER BY a.created DESC</otherwise>		</choose>				<if test="start != null and start >= 0 and pageSize != null and pageSize >= 0">			LIMIT #{start},#{pageSize}		</if>		<if test="start != null and start > 0 and pageSize == null">			LIMIT #{pageSize}		</if>	</select>			<select id="searchGoodsList_count" resultType="java.lang.Integer">		SELECT COUNT(DISTINCT a.id)		FROM t_t_goods a         LEFT JOIN t_t_goods_category b ON a.goodsCategoryId = b.id AND a.tenantId = b.tenantId AND b.dataStatus = 1		WHERE a.dataStatus =  1 AND a.tenantId = #{tenantId} 		<if test="queryKey != null" >			<trim prefix="AND (" suffix=")">					a.goodsNo = LPAD(#{queryKey}, 5, 0) OR a.goodsName like CONCAT(#{queryKey},'%')  					OR a.goodsSpec like CONCAT('%',#{queryKey},'%') OR a.remark like CONCAT('%',#{queryKey},'%')			</trim>		</if>		<if test="goodsCategoryId != null " >			AND a.goodsCategoryId = #{goodsCategoryId}		</if>		<if test="isCustomDiscount != null and isCustomDiscount == 1" >			AND a.discount = #{discount}		</if>		<if test="isCustomDiscount != null and isCustomDiscount == 0" >			AND a.isCustomDiscount = 0		</if>		<if test="lastOrderDay != null and lastOrderDay > 0" >			AND DATEDIFF(NOW(),a.lastOrderDate) &lt;= #{lastOrderDay}		</if>		<if test="goodsType != null" >			AND goodsType = #{goodsType}		</if>	</select>		<resultMap id="GoodsListResultMap" type="com.xcrm.mt.bis.goods.vo.GoodsListResultInfoVo">		<result property="id" column="id" />		<result property="goodsNo" column="goodsNo" />		<result property="goodsName" column="goodsName" />		<result property="goodsImage" column="goodsImage" />		<result property="stockCount" column="stockCount" />		<result property="price" column="price" />		<result property="goodsRealCost" column="goodsRealCost" />	</resultMap>		<select id="queryGoodsList" resultMap="GoodsListResultMap">		SELECT a.id,a.goodsNo,a.goodsName,a.goodsImage,a.stockCount,a.price,a.goodsRealCost		FROM t_t_goods a 		WHERE a.dataStatus =  1 AND a.tenantId = #{tenantId} 		<if test="queryKey != null" >			<trim prefix="AND (" suffix=")">					a.goodsNo = LPAD(#{queryKey}, 5, 0) OR a.goodsName like CONCAT('%',#{queryKey},'%')			</trim>		</if>		GROUP BY a.id		ORDER BY a.created DESC		<if test="start != null and start >= 0 and pageSize != null and pageSize >= 0">			LIMIT #{start},#{pageSize}		</if>		<if test="start != null and start > 0 and pageSize == null">			LIMIT #{pageSize}		</if>	</select>			<resultMap id="GoodsInfoResultMap" type="com.xcrm.mt.bis.goods.vo.GoodsResultInfoVo">		<result property="id" column="id" />		<result property="goodsNo" column="goodsNo" />		<result property="barCode" column="barCode" />		<result property="goodsTypeName" column="goodsTypeName" />		<result property="goodsType" column="goodsType" />		<result property="goodsName" column="goodsName" />		<result property="goodsCategoryName" column="goodsCategoryName" />		<result property="goodsCategoryId" column="goodsCategoryId" />		<result property="goodsImage" column="goodsImage" />		<result property="price" column="price" />		<result property="cost" column="cost" />		<result property="isCustomDiscount" column="isCustomDiscount" />		<result property="discount" column="discount" />		<result property="vendorName" column="vendorName" />		<result property="vendorId" column="vendorId" />		<result property="stockCount" column="stockCount" />		<result property="goodsSpec" column="goodsSpec" />		<result property="isAllowOnline" column="isAllowOnline" />		<result property="remark" column="remark" />		<result property="goodsDetail" column="goodsDetail" />		<result property="goodsDetailId" column="goodsDetailId" />	</resultMap>		<select id="queryGoods" resultMap="GoodsInfoResultMap">		SELECT a.id,a.goodsNo,a.barCode,a.goodsType,a.goodsName,a.goodsCategoryId,		       a.goodsImage,a.price,a.cost,a.isCustomDiscount,a.discount,a.vendorId,			   a.stockCount,a.goodsSpec,a.isAllowOnline,a.remark,e.goodsDetail,			   b.categoryName as goodsCategoryName,c.sysName as goodsTypeName,d.vendorName		FROM t_t_goods a 		LEFT JOIN t_t_goods_category b ON a.goodsCategoryId = b.id AND a.tenantId = b.tenantId AND b.dataStatus = 1		LEFT JOIN t_b_sys_code c ON a.goodsType = c.sysCode AND c.dataStatus = 1		LEFT JOIN t_t_goods_vendor d ON a.vendorId = d.id AND a.tenantId = d.tenantId AND d.dataStatus = 1		LEFT JOIN t_t_goods_detail e ON a.id = e.goodsId AND a.tenantId = e.tenantId		WHERE a.tenantId = #{tenantId} AND a.id = #{goodsId} AND a.dataStatus = 1	</select>		<select id="queryCustomGoodsNo" resultType="java.lang.Long">		SELECT goodsNo		FROM t_t_goods a 		WHERE a.tenantId = #{tenantId} AND isCustomGoodsNo = 1 AND goodsNo &gt;= #{goodsNo}	</select>		<select id="queryGoodsBarCodeInfo" resultType="java.lang.String">		SELECT originalMsg		FROM t_t_goods_barcode		WHERE barCode = #{barCode}	</select></mapper>